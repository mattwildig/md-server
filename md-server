#!/usr/bin/env ruby

require 'sinatra'
require 'tilt'

enable :run

get "/" do
  @files = Dir["*"].select{|f| Tilt[f]}
  if @files == []
    "No template files found."
  else
    erb :index
  end
end

get %r{^/((.*)$)} do
  name = params[:captures][0]
  if Tilt[name]
    Tilt.new(name).render
  else
    [404, "Nothing to render for \"#{name}\""]
  end
end

__END__

@@index

<ul>
<% @files.each do |f| %>
  <%="<li><a href='#{f}'>#{f}</a></li>"%>
<%end%>
</ul>
  