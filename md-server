#!/usr/bin/env ruby

require 'rack'
require 'tilt'

@files = Rack::Directory.new('.')

app = lambda do |env|
  path = env['PATH_INFO'][1..-1]
  
  begin
    return [200, {"Content-Type" => "text/html"}, [Tilt.new(path).render]]
  rescue Errno::ENOENT
    return [404, {"Content-Type" => "text/html"}, ["No such file \"#{path}\""]]
  end if Tilt[path]
  
  @files.call(env)
end

Rack::Server.start :app => app, :Port => 9292

  